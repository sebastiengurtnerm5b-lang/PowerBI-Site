<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Power BI Reports</title>

  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f4f4f4; }
    header { background:#0078D4; color:#fff; padding:20px; font-size:2em; text-align:center; }
    section { margin:20px; background:#fff; padding:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    h2 { margin-bottom:10px; }
    .report-frame { width:100%; height:900px; border:none; }
  </style>
</head>

<body>

<!-- ===== Boutons Login / Logout visibles même sans connexion ===== -->
<header style="background:#0078D4; color:#fff; padding:20px; font-size:2em; display:flex; justify-content:center; align-items:center; position:relative;">
  <span style="text-align:center;">My Power BI Reports</span>

  <div style="position:absolute; right:20px;">
    <button id="loginBtn" onclick="netlifyIdentity.open()" 
      style="background:#fff; color:#0078D4; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-size:1em; margin-right:10px;">
      Login
    </button>

    <button id="logoutBtn" onclick="netlifyIdentity.logout()" 
      style="background:#fff; color:#0078D4; border:none; padding:10px 20px; border-radius:5px; cursor:pointer; font-size:1em; display:none;">
      Logout
    </button>
  </div>
</header>

<!-- ===== Contenu protégé (caché tant que pas connecté) ===== -->
<div id="protectedContent" style="display:none;">


  <!-- Report 1 -->
  <section>
    <h2>Report 1: Turnover, Leavers, Starters Metrics</h2>

    <iframe class="report-frame" 
    src="https://app.powerbi.com/reportEmbed?reportId=41503a57-7ce8-4b9b-8423-c990e38119b7&autoAuth=true&ctid=c162a585-4fef-44bd-9271-d96409d0a349" 
    allowFullScreen="true"></iframe>
  </section>

  <!-- Report 2 -->
  <section>
    <h2>Report 2: Joby McKenzie report</h2>

    <iframe class="report-frame" 
    src="https://app.powerbi.com/reportEmbed?reportId=fc05a3b1-2c7a-4155-9c78-fe55e5f82038&autoAuth=true&ctid=c162a585-4fef-44bd-9271-d96409d0a349" 
    allowFullScreen="true"></iframe>
  </section>

  <!-- Report 3 -->
  <section>
    <h2>Report 3: Hybrid Work Model population</h2>

    <iframe class="report-frame" 
    src="https://app.powerbi.com/reportEmbed?reportId=0b0eceb3-0460-4955-854a-39eac7d2782c&autoAuth=true&ctid=c162a585-4fef-44bd-9271-d96409d0a349"
    allowFullScreen="true"></iframe>
  </section>

</div> <!-- Fin contenu protégé -->



<!-- ===== Script Netlify Identity ===== -->
<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {

    if (!window.netlifyIdentity) return;

    // S'assure que Identity est bien initialisé
    netlifyIdentity.init();

    // Quand Identity est prêt
    netlifyIdentity.on("init", (user) => {
      if (user) showContent();
      else hideContent();
    });

    // Quand l'utilisateur se connecte
    netlifyIdentity.on("login", () => {
      showContent();
    });

    // Quand l'utilisateur se déconnecte
    netlifyIdentity.on("logout", () => {
      hideContent();
    });

    function showContent() {
      document.getElementById("protectedContent").style.display = "block";
      document.getElementById("loginBtn").style.display = "none";
      document.getElementById("logoutBtn").style.display = "inline-block";
    }

    function hideContent() {
      document.getElementById("protectedContent").style.display = "none";
      document.getElementById("loginBtn").style.display = "inline-block";
      document.getElementById("logoutBtn").style.display = "none";
    }
  });
</script>

</body>
</html>
